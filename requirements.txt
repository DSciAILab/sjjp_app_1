import streamlit as st
import pandas as pd

# Dummy functions and data for demonstration
def login():
    username = st.text_input("Username")
    password = st.text_input("Password", type="password")
    if st.button("Login"):
        # Dummy login check
        if username == "admin" and password == "admin":
            st.session_state["logged_in"] = True
            st.session_state["user_role"] = "Admin"
            st.session_state["username"] = username
        elif username == "user" and password == "user":
            st.session_state["logged_in"] = True
            st.session_state["user_role"] = "User"
            st.session_state["username"] = username
        else:
            st.error("Invalid username or password")

def submit_request():
    st.header("Submit Request")
    st.write("Use the form below to submit your request.")
    # Example multi-item form
    with st.form("request_form"):
        item_name = st.text_input("Item Name")
        quantity = st.number_input("Quantity", min_value=1, step=1)
        description = st.text_area("Description")
        submitted = st.form_submit_button("Submit")
        if submitted:
            st.success(f"Request for {quantity} x {item_name} submitted with status Pending.")

def manage_requests():
    st.header("Manage Requests")
    # Example request list with status dropdown and color coding
    data = {
        "Request ID": [1, 2, 3],
        "Item": ["Notebook", "Pen", "Eraser"],
        "Quantity": [10, 20, 5],
        "Status": ["Pending", "Approved", "Denied"]
    }
    df = pd.DataFrame(data)
    
    status_options = ["Pending", "Approved", "Denied"]
    for i in range(len(df)):
        cols = st.columns([1, 2, 1, 2])
        cols[0].write(df.at[i, "Request ID"])
        cols[1].write(df.at[i, "Item"])
        cols[2].write(df.at[i, "Quantity"])
        new_status = cols[3].selectbox("Status", status_options, index=status_options.index(df.at[i, "Status"]), key=f"status_{i}")
        color = {"Pending": "orange", "Approved": "green", "Denied": "red"}[new_status]
        cols[3].markdown(f"<span style='color:{color};font-weight:bold'>{new_status}</span>", unsafe_allow_html=True)
        df.at[i, "Status"] = new_status

def admin_schools():
    st.header("Admin Schools")
    # Example school management table
    data = {
        "School ID": [101, 102, 103],
        "School Name": ["Greenwood High", "Maple Leaf Academy", "Sunnydale School"],
        "Location": ["New York", "California", "Texas"]
    }
    df = pd.DataFrame(data)
    edited_df = st.data_editor(df, num_rows="dynamic")
    st.write("Edit the school details above.")

def main():
    st.set_page_config(layout="wide")
    if "logged_in" not in st.session_state:
        st.session_state["logged_in"] = False
        st.session_state["user_role"] = None
        st.session_state["username"] = None

    if not st.session_state["logged_in"]:
        login()
    else:
        st.write(f"Welcome, {st.session_state['username']}!")
        options = ["üì¶ Submit Request", "üìã Manage Requests"]
        if st.session_state["user_role"] == "Admin":
            options.append("‚öôÔ∏è Admin Schools")
        selected = st.radio("Select an option:", options, horizontal=True)
        
        if selected == "üì¶ Submit Request":
            submit_request()
        elif selected == "üìã Manage Requests":
            manage_requests()
        elif selected == "‚öôÔ∏è Admin Schools":
            admin_schools()

if __name__ == "__main__":
    main()
